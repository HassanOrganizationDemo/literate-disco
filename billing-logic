Here goes the whole logic (MASSIVE CONTROLLER)!
